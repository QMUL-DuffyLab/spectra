this code takes MD data of some pigments along with corresponding spectroscopic data and calculates couplings, excitonic states, absorption and fluorescence spectra and population dynamics. it\textquotesingle{}s not particularly convenient to use (or well written!) yet, pls bear with me \+:)

throughout this repo I\textquotesingle{}ve labelled pigments by ligand codes from R\+C\+SB P\+DB; e.\+g. chlorophyll a is C\+LA, chlorophyll b is C\+HL, fucoxanthin is A86, etc. etc.

lineshapes for individual pigments are in the lineshape folder; the only reason to mess with these is if the parameters or spectral desnsity ansatzes change.\hypertarget{md_README_autotoc_md22}{}\doxysection{R\+E\+Q\+U\+I\+R\+E\+M\+E\+N\+TS}\label{md_README_autotoc_md22}
basic requirements are {\ttfamily gcc, gfortran, L\+A\+P\+A\+CK, F\+F\+TW}. I use exactly one {\ttfamily gnu99} C extension ({\ttfamily strndup}) which could easily be changed but I\textquotesingle{}m lazy, otherwise I think it\textquotesingle{}s all strictly {\ttfamily C99}. The fortran code is all strictly {\ttfamily f2008}, not that it\textquotesingle{}s very complicated or requires any specific F2008 behaviour. For the plotting scripts you need python 3.\+7, numpy and matplotlib set up with latex support -\/ I use latex in the line and axis labels because I like them to look nice. If you have all those things you might need to add something like 
\begin{DoxyCode}{0}
\DoxyCodeLine{plt.rcParams['text.usetex'] = True}
\DoxyCodeLine{plt.rcParams['text.latex.preamble'] = \(\backslash\)usepackage\{amsmath\}\(\backslash\)usepackage\{sfmath\}}
\end{DoxyCode}


but NB I have no idea how to escape that preamble correctly -\/ I have these set in my matplotlibrc.\hypertarget{md_README_autotoc_md23}{}\doxysection{C\+O\+M\+P\+I\+L\+A\+T\+I\+ON}\label{md_README_autotoc_md23}
for making the required programs it should be sufficient (is for me) to do {\ttfamily make} in the root folder; it loops over the three subdirs and runs the makefile in each. to force recompilation of everything do {\ttfamily make clean \&\& make all}.\hypertarget{md_README_autotoc_md24}{}\doxysection{R\+U\+N\+N\+I\+NG}\label{md_README_autotoc_md24}
just do {\ttfamily ./scripts/run.py -\/f N\+UM} in the root folder for whichever frame number {\ttfamily N\+UM} you want to look at. Running it with {\ttfamily -\/f 0} will loop over 1000 frames; I haven\textquotesingle{}t bothered yet to put in a check and see how many frames there are although that\textquotesingle{}d probably be easy enough.

the python script is clever enough to notice if the required lineshape data isn\textquotesingle{}t there and will attempt to create it if it isn\textquotesingle{}t. there are also two parameters which affect everything; T, the temperature we\textquotesingle{}re simulating at and τ, the length (in femtoseconds) that we\textquotesingle{}ve calculated line-\/broadening functions for. the defaults are set in the run script as 300K and 2048 (setting 2048 instead of, say, 2000, makes basically no difference. but I get to choose because I\textquotesingle{}m writing the code.); the script checks whether these match the values in the {\ttfamily lineshape} directory, specifically in {\ttfamily lineshape/in/protocol}. if they don\textquotesingle{}t, it recalculates the line-\/broadening functions with whatever T, τ you give it. it doesn\textquotesingle{}t check for the executable files being there because if they\textquotesingle{}re not it\textquotesingle{}ll just fail; you can run {\ttfamily make clean \&\& make all} yourself.

A note on input file setup\+: the big folder of L\+H\+C\+II snapshots isn\textquotesingle{}t included here because it\textquotesingle{}s like 100MB or whatever, but {\ttfamily scripts/fix\+\_\+files.\+sh} is set up to generate input files in the right way. The fortran code requires four {\ttfamily fmt=\%16.\+8e} columns where the first three are coordinates of an atom and the fourth is its Tr\+Esp charge; the script pulls coordinates from a P\+DB file and stitches them together with the corresponding Tr\+Esp charges, as long as they\textquotesingle{}re stored in the form

{\ttfamily A\+T\+O\+M\+\_\+\+N\+U\+M\+B\+ER A\+T\+O\+M\+\_\+\+N\+A\+ME P\+A\+R\+T\+I\+A\+L\+\_\+\+C\+H\+A\+R\+GE}

and the atom names match those in the P\+DB. It does this by generating dicts and checking keys in both files.

The script {\ttfamily scripts/plot\+\_\+aw.\+py} is run after each frame in the run script and plots A(w) and F(w), with corresponding experimental data ripped from the supplementary material in \href{http://arxiv.org/abs/1512.00887}{\texttt{ Tomas Mancal\textquotesingle{}s arxiv paper}} (ultimately from a different paper but I forget where). It also plots them together on the same axis without doing any normalisation to see what the raw data looks like. Finally the script {\ttfamily scripts/average\+\_\+spectra.\+py} loops over all 1000 frames and sums A(w) and F(w), then plots their averages in the same way -\/ reason for this being that an individual frame of MD data can have weird instantaneous couplings due to the movement of the pigments. 