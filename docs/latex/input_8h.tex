\hypertarget{input_8h}{}\doxysection{spectra/src/input.h File Reference}
\label{input_8h}\index{spectra/src/input.h@{spectra/src/input.h}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../../lineshape/src/parameters.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../../lineshape/src/functions.\+h\char`\"{}}\newline
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structInput}{Input}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{structInput}{Input}} struct for important parameters and filenames where the exciton-\/basis data is to be read in from. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{input_8h_abb31fad64145cc3d1605d8da44c4dc0a}{M\+A\+X\+\_\+\+P\+I\+G\+M\+E\+N\+T\+\_\+\+N\+U\+M\+B\+ER}}~200
\item 
\#define \mbox{\hyperlink{input_8h_a79746149dba4f3da9b7d0f09f288e782}{EC}}~1.\+6022E-\/19
\item 
\#define \mbox{\hyperlink{input_8h_a73f0647950b85591fbe61fff44d45c2e}{E0}}~8.\+854E-\/12
\item 
\#define \mbox{\hyperlink{input_8h_a0ccf3707daee917422a8c2b982ad40d2}{J\+P\+E\+R\+I\+N\+V\+CM}}~1.\+986E-\/23
\item 
\#define \mbox{\hyperlink{input_8h_a31c3b7a132ba8cec8e7f5ad3138f940f}{K\+C\+O\+UL}}~(1. / (4. $\ast$ \mbox{\hyperlink{functions_8c_ae71449b1cc6e6250b91f539153a7a0d3}{M\+\_\+\+PI}} $\ast$ \mbox{\hyperlink{input_8h_a73f0647950b85591fbe61fff44d45c2e}{E0}} $\ast$ 0.\+5))
\item 
\#define \mbox{\hyperlink{input_8h_ac0fc7254424c9b2b45ea885c39e00fcd}{T\+O\+FS}}~(2. $\ast$ \mbox{\hyperlink{functions_8c_ae71449b1cc6e6250b91f539153a7a0d3}{M\+\_\+\+PI}} $\ast$ \mbox{\hyperlink{parameters_8h_a992459bfa97e3ecf21581f8a4b959df4}{C\+MS}} $\ast$ 100. $\ast$ 1E-\/15)
\item 
\#define \mbox{\hyperlink{input_8h_a250ba8d4834d499d928a0adb0f733a1f}{T\+O\+C\+M1}}~((1.\+295E3 $\ast$ 8.\+988E9 $\ast$ 0.\+5))
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structInput}{Input}} $\ast$ \mbox{\hyperlink{input_8h_afe82bf3e4a5eaab78fd2b6fafc71385e}{read\+\_\+input\+\_\+file}} (char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Reads in the output from the fortran code, returns \mbox{\hyperlink{structInput}{Input}} struct. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{input_8h_aca86a581177852bac7f607ba4a0d62b4}{read}} (char $\ast$input\+\_\+file, unsigned int N)
\begin{DoxyCompactList}\small\item\em Reads a file with one double per line and returns it as an array. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{input_8h_a7a9c614508eb70065d1fac49dbb6a38a}{read\+\_\+mu}} (char $\ast$input\+\_\+file, unsigned int N)
\begin{DoxyCompactList}\small\item\em Reads transition dipole moments from file and returns array. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{input_8h_af474d86499b3c3f224327c7f59b50e33}{read\+\_\+eigvecs}} (char $\ast$input\+\_\+file, unsigned int N)
\begin{DoxyCompactList}\small\item\em Reads in N x N eigenvector matrix and returns as an array. \end{DoxyCompactList}\item 
double complex $\ast$$\ast$ \mbox{\hyperlink{input_8h_acba6a24db8518501663fad92f6e721e4}{read\+\_\+gi}} (char $\ast$input\+\_\+files\mbox{[}$\,$\mbox{]}, unsigned int N, unsigned int tau)
\begin{DoxyCompactList}\small\item\em Read in the set of line-\/broadening functions, return as 2d array. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{input_8h_a73f0647950b85591fbe61fff44d45c2e}\label{input_8h_a73f0647950b85591fbe61fff44d45c2e}} 
\index{input.h@{input.h}!E0@{E0}}
\index{E0@{E0}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{E0}{E0}}
{\footnotesize\ttfamily \#define E0~8.\+854E-\/12}

\mbox{\Hypertarget{input_8h_a79746149dba4f3da9b7d0f09f288e782}\label{input_8h_a79746149dba4f3da9b7d0f09f288e782}} 
\index{input.h@{input.h}!EC@{EC}}
\index{EC@{EC}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{EC}{EC}}
{\footnotesize\ttfamily \#define EC~1.\+6022E-\/19}

\mbox{\Hypertarget{input_8h_a0ccf3707daee917422a8c2b982ad40d2}\label{input_8h_a0ccf3707daee917422a8c2b982ad40d2}} 
\index{input.h@{input.h}!JPERINVCM@{JPERINVCM}}
\index{JPERINVCM@{JPERINVCM}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{JPERINVCM}{JPERINVCM}}
{\footnotesize\ttfamily \#define J\+P\+E\+R\+I\+N\+V\+CM~1.\+986E-\/23}

\mbox{\Hypertarget{input_8h_a31c3b7a132ba8cec8e7f5ad3138f940f}\label{input_8h_a31c3b7a132ba8cec8e7f5ad3138f940f}} 
\index{input.h@{input.h}!KCOUL@{KCOUL}}
\index{KCOUL@{KCOUL}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{KCOUL}{KCOUL}}
{\footnotesize\ttfamily \#define K\+C\+O\+UL~(1. / (4. $\ast$ \mbox{\hyperlink{functions_8c_ae71449b1cc6e6250b91f539153a7a0d3}{M\+\_\+\+PI}} $\ast$ \mbox{\hyperlink{input_8h_a73f0647950b85591fbe61fff44d45c2e}{E0}} $\ast$ 0.\+5))}

\mbox{\Hypertarget{input_8h_abb31fad64145cc3d1605d8da44c4dc0a}\label{input_8h_abb31fad64145cc3d1605d8da44c4dc0a}} 
\index{input.h@{input.h}!MAX\_PIGMENT\_NUMBER@{MAX\_PIGMENT\_NUMBER}}
\index{MAX\_PIGMENT\_NUMBER@{MAX\_PIGMENT\_NUMBER}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{MAX\_PIGMENT\_NUMBER}{MAX\_PIGMENT\_NUMBER}}
{\footnotesize\ttfamily \#define M\+A\+X\+\_\+\+P\+I\+G\+M\+E\+N\+T\+\_\+\+N\+U\+M\+B\+ER~200}

\mbox{\Hypertarget{input_8h_a250ba8d4834d499d928a0adb0f733a1f}\label{input_8h_a250ba8d4834d499d928a0adb0f733a1f}} 
\index{input.h@{input.h}!TOCM1@{TOCM1}}
\index{TOCM1@{TOCM1}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{TOCM1}{TOCM1}}
{\footnotesize\ttfamily \#define T\+O\+C\+M1~((1.\+295E3 $\ast$ 8.\+988E9 $\ast$ 0.\+5))}

\mbox{\Hypertarget{input_8h_ac0fc7254424c9b2b45ea885c39e00fcd}\label{input_8h_ac0fc7254424c9b2b45ea885c39e00fcd}} 
\index{input.h@{input.h}!TOFS@{TOFS}}
\index{TOFS@{TOFS}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{TOFS}{TOFS}}
{\footnotesize\ttfamily \#define T\+O\+FS~(2. $\ast$ \mbox{\hyperlink{functions_8c_ae71449b1cc6e6250b91f539153a7a0d3}{M\+\_\+\+PI}} $\ast$ \mbox{\hyperlink{parameters_8h_a992459bfa97e3ecf21581f8a4b959df4}{C\+MS}} $\ast$ 100. $\ast$ 1E-\/15)}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{input_8h_aca86a581177852bac7f607ba4a0d62b4}\label{input_8h_aca86a581177852bac7f607ba4a0d62b4}} 
\index{input.h@{input.h}!read@{read}}
\index{read@{read}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{read()}{read()}}
{\footnotesize\ttfamily double$\ast$ read (\begin{DoxyParamCaption}\item[{char $\ast$}]{input\+\_\+file,  }\item[{unsigned int}]{N }\end{DoxyParamCaption})}



Reads a file with one double per line and returns it as an array. 

Note that this and every other function in here returns a pointer to a malloc\textquotesingle{}d object, so they all need to be freed somewhere! \mbox{\Hypertarget{input_8h_af474d86499b3c3f224327c7f59b50e33}\label{input_8h_af474d86499b3c3f224327c7f59b50e33}} 
\index{input.h@{input.h}!read\_eigvecs@{read\_eigvecs}}
\index{read\_eigvecs@{read\_eigvecs}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{read\_eigvecs()}{read\_eigvecs()}}
{\footnotesize\ttfamily double$\ast$$\ast$ read\+\_\+eigvecs (\begin{DoxyParamCaption}\item[{char $\ast$}]{input\+\_\+file,  }\item[{unsigned int}]{N }\end{DoxyParamCaption})}



Reads in N x N eigenvector matrix and returns as an array. 

It occurs to me as I write these docs that I could do away with separate functions just by taking two ints n and m and reading in an n x m array from those. Would only require a check that both are greater than 1.

Other than that same deal, reads N x N floats, outputs N x N array. \mbox{\Hypertarget{input_8h_acba6a24db8518501663fad92f6e721e4}\label{input_8h_acba6a24db8518501663fad92f6e721e4}} 
\index{input.h@{input.h}!read\_gi@{read\_gi}}
\index{read\_gi@{read\_gi}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{read\_gi()}{read\_gi()}}
{\footnotesize\ttfamily double complex$\ast$$\ast$ read\+\_\+gi (\begin{DoxyParamCaption}\item[{char $\ast$}]{input\+\_\+files\mbox{[}$\,$\mbox{]},  }\item[{unsigned int}]{N,  }\item[{unsigned int}]{tau }\end{DoxyParamCaption})}



Read in the set of line-\/broadening functions, return as 2d array. 

The g\+\_\+i(t) functions are the mixed line-\/broadening functions output by the fortran code, consisting of tau complex elements each.

Honestly it\textquotesingle{}s been a while since I wrote these functions and I can\textquotesingle{}t remember now why this one uses fscanf instead of the fgets etc. from the other functions -\/ maybe I could edit the others to use fscanf instead and save myself some duplication of effort. Either way, it generates gi\mbox{[}i\mbox{]}\mbox{[}j\mbox{]}, where $ i \in 0 \rightarrow N - 1 $, $ j \in 0 \rightarrow \tau - 1 $ . \mbox{\Hypertarget{input_8h_afe82bf3e4a5eaab78fd2b6fafc71385e}\label{input_8h_afe82bf3e4a5eaab78fd2b6fafc71385e}} 
\index{input.h@{input.h}!read\_input\_file@{read\_input\_file}}
\index{read\_input\_file@{read\_input\_file}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{read\_input\_file()}{read\_input\_file()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structInput}{Input}}$\ast$ read\+\_\+input\+\_\+file (\begin{DoxyParamCaption}\item[{char $\ast$}]{filename }\end{DoxyParamCaption})}



Reads in the output from the fortran code, returns \mbox{\hyperlink{structInput}{Input}} struct. 

This is not very portable and to some extent is duplicating effort made in the lineshape code (\mbox{\hyperlink{parameters_8c}{lineshape/src/parameters.\+c}}) -\/ there\textquotesingle{}s probably a way of fixing that / a library I could use instead but whatever.

Note that the number of gi\+\_\+files isn\textquotesingle{}t known till runtime because neither is N, the number of pigments; luckily C99 allows us to leave the last member of a struct with variable size and then malloc it later, which is what I do here.

fgets() reads in the newline at the end of the line as well; to stop that newline from being passed to fopen() later I use the line\mbox{[}strcspn()\mbox{]} = 0 trick to set the newline to a null char.

strndup is the last remaining gnu99 extension I use in the whole repo; I will eventually get around to fixing that but I\textquotesingle{}m lazy \+:)

NB\+: check how to free those malloc\textquotesingle{}d struct members, I can\textquotesingle{}t remember if there\textquotesingle{}s some fancy stuff you have to do or not. \mbox{\Hypertarget{input_8h_a7a9c614508eb70065d1fac49dbb6a38a}\label{input_8h_a7a9c614508eb70065d1fac49dbb6a38a}} 
\index{input.h@{input.h}!read\_mu@{read\_mu}}
\index{read\_mu@{read\_mu}!input.h@{input.h}}
\doxysubsubsection{\texorpdfstring{read\_mu()}{read\_mu()}}
{\footnotesize\ttfamily double$\ast$$\ast$ read\+\_\+mu (\begin{DoxyParamCaption}\item[{char $\ast$}]{input\+\_\+file,  }\item[{unsigned int}]{N }\end{DoxyParamCaption})}



Reads transition dipole moments from file and returns array. 

This one (and the others below) are extremely hacky -\/ the numbers are hardcoded (19, 20, 22) based on the output format of the fortran code. It disgusts me a little bit every time I remember writing it. Not much going on other than that -\/ reads 3 doubles a line, N lines, returns a pointer to the resulting array. 